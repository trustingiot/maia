# MAIA | Masked Authenticated IOTA Address

## General description

A public MAM channel which always returns the last message.

Characteristics:
- Public MAM channel
- Security level 2
- Channel root = MAIA address

&nbsp;

## Current version

- Number: 3
- Date: 2018.07.01

&nbsp;

## Methods

*get*
- Returns the MAIA message
- get(maia):payload

*post*
- Creates or updates the MAIA message
- post(payload, seed = [autogenerated]):message

&nbsp;

## MAIA

Denominations:
- Root: Main channel
- Layer: Sub-channel
- Parent: Channel that created the current channel
- Node: Root or intermediate layer
- Final layer: Layer with data (layers = 0)
- Data: Message with final information

Config payload:
- Root of channel
    - protocol: 'maia'. Identifier of a MAIA address
    - version: Integer. Number of version of the MAIA address
    - layers: Integer (default = 3, minimum = 0). Number of layers
    - depth: Integer (default = 15, minimum = 1). Maximum depth of the layers
- Root of a channel in a layer
    - layers: Integer (= parent.layers - 1). root.layers = 2 -> layer_1.layers = 1 -> layer_1_1 = 0
    - depth: Integer (= parent.depth)
- Message in an intermediate layer
    - next: Address of the next channel

Data payload:
- Message with final information
    - field: value (field = name of the field, value = value of the field)

&nbsp;

## Example of MAIA

Create channel (i = 1)

    >>> POST(seed: X, data:{address:'AAA', twitter:'fjestrella'})
    
    // Root first message
    // ID(=MAIA): A
    // Seed_A = X
    config {
        protocol: 'maia'
        version: 3
        layers: 2
        depth: 4
    }
    
    // Root channel second message
    config {
        next: B
    }
    
    // B channel first message
    // Seed_B = SHA256(Seed_A, 0)
    config {
        layers: 1
        depth: 4
    }
    
    // B channel second message
    config {
        next: C
    }
    
    // C channel first message
    // Seed_C = SHA256(Seed_B, 0)
    config {
        layers: 0
        depth: 4
    }
    
    // C channel second message
    data {
        address: 'AAA'
        twitter: 'fjestrella'
    }
    
    <<< {status: MAIA.RESPONSE_CODE.OK, maia: A}
    
    >>> GET(maia: A)
    <<< {address: 'AAA', twitter: 'fjestrella'}
    
    // 6 steps => R_0 > R_1 > B_0 > B_1 > C_0 > C_1

Update field 'twitter' (i = 2)

    >>> POST(seed: X, data:{twitter:'trustingiot'})
    
    // C channel third message
    data {
        address: 'AAA'
        twitter: 'trustingiot'
    }
    
    <<< {status: MAIA.RESPONSE_CODE.OK, maia: A}
    
    >>> GET(MAIA: A)
    <<< {address: 'AAA', twitter: 'trustingiot'}
    
    // 7 steps (+1) => R_0 > R_1 > B_0 > B_1 > C_0 > C_1 > C_2

Add field 'other' (i = 3)

    >>> POST(seed: X, data:{other:'example'})
    
    // C channel four message
    data {
        address: 'AAA'
        twitter: 'trustingiot'
        other: 'example'
    }
    
    <<< {status: MAIA.RESPONSE_CODE.OK, maia: A}
    
    >>> GET(maia: A)
    <<< {address: 'AAA', twitter: 'trustingiot', other:'example'}
    
    // 8 steps (+1) => R_0 > R_1 > B_0 > B_1 > C_0 > C_1 > C_2 > C_3

Remove field 'twitter' (i = 4)

    >>> POST(seed: X, data:{twitter:''})
    
    // C channel fifth message
    data {
        address: 'AAA'
        other: 'example'
    }
    
    <<< {status: MAIA.RESPONSE_CODE.OK, maia: A}
    
    >>> GET(maia: A)
    <<< {address: 'AAA', other:'example'}
    
    // 9 steps (+1) => R_0 > R_1 > B_0 > B_1 > C_0 > C_1 > C_2 > C_3 > C_4

Remove field 'other' (i = 5)

    >>> POST(seed: X, payload:{other:''})
    
    // B channel third message
    config {
        next: D
    }
    
    // D channel first message
    // Seed_D = SHA256(Seed_B, 1)
    config {
        layers: 0
        depth: 4
    }
    
    // D channel second message
    data {
        address: 'AAA'
    }
    
    <<< {status: MAIA.RESPONSE_CODE.OK, maia: A}
    
    >>> GET(maia: A)
    <<< {address: 'AAA'}
    
    // 7 steps (-2) => R_0 > R_1 > B_0 > B_1 > B_2 > D_0 > D_1

i = 30

    // 11 steps => R_0 > R_1 > R_2 > G_0 > G_1 > G_2 > G_3 > G_4 > K_0 > K_1 > K_2

i = 50

    // 10 steps => R_0 > R_1 > R_2 > R_3 > R_4 > P_0 > P_1 > Q_0 > Q_1 > Q_2

&nbsp;

## View

A view is an independent transaction that indexes a field of a MAIA address

Methods:
 - createView(maia:address, field:field to be indexed, callback:callback function used in browser execution):transaction hash
 - readView(view:view address, callback:callback function used in browser execution):field value

&nbsp;

## Example of Views

Create a MAIA address

    >>> POST(seed: x, data:{address:'my address', other:'example'})
    <<< {status: MAIA.RESPONSE_CODE.OK, maia: A}
    
    >>> GET(maia: A)
    <<< {address:'my address', other:'example'}

Create a view

    >>> createView(maia: A, field:'address')
    <<< B // Hash of the transaction
    
    >>> readView(view: B)
    <<< 'my address'

Update the MAIA address

    >>> POST(seed: x, data:{address:'my new address'})
    <<< {status: MAIA.RESPONSE_CODE.OK, maia: A}
    
    >>> readView(view: B)
    <<< 'my new address'